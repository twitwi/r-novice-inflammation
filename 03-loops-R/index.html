<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-01-30 00:03:54 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="/swc-releases/1999.12/r-novice-inflammation">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-swc.ico" />
    
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Programming with R: Analyzing Multiple Data Sets</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li><a href="../reference/">Reference</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-starting-with-data/">Analyzing Patient Data</a></li>
            
            <li><a href="../02-func-R/">Creating Functions</a></li>
            
            <li><a href="../03-loops-R/">Analyzing Multiple Data Sets</a></li>
            
            <li><a href="../04-cond/">Making Choices</a></li>
            
            <li><a href="../05-cmdline/">Command-Line Programs</a></li>
            
            <li><a href="../06-best-practices-R/">Best Practices for Writing R</a></li>
            
            <li><a href="../07-knitr-R/">Dynamic Reports with knitr</a></li>
            
            <li><a href="../08-making-packages-R/">Making Packages in R</a></li>
            
            <li><a href="../09-supp-intro-rstudio/">Introduction to RStudio</a></li>
            
            <li><a href="../10-supp-addressing-data/">Addressing Data</a></li>
            
            <li><a href="../11-supp-read-write-csv/">Reading and Writing CSV Files</a></li>
            
            <li><a href="../12-supp-factors/">Understanding Factors</a></li>
            
            <li><a href="../13-supp-data-structures/">Data Types and Structures</a></li>
            
            <li><a href="../14-supp-call-stack/">The Call Stack</a></li>
            
            <li><a href="../15-supp-loops-in-depth/">Loops in R</a></li>
            
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../02-func-R/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Programming with R</a></h3>
    <h1 class="maintitle">Analyzing Multiple Data Sets</h1>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../04-cond/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 30 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I do the same thing to multiple data sets?</p>
</li>
	
	<li><p>How do I write a <code class="highlighter-rouge">for</code> loop?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Explain what a <code class="highlighter-rouge">for</code> loop does.</p>
</li>
	
	<li><p>Correctly write <code class="highlighter-rouge">for</code> loops to repeat simple calculations.</p>
</li>
	
	<li><p>Trace changes to a loop variable as the loop runs.</p>
</li>
	
	<li><p>Trace changes to other variables as they are updated by a <code class="highlighter-rouge">for</code> loop.</p>
</li>
	
	<li><p>Use a function to get a list of filenames that match a simple pattern.</p>
</li>
	
	<li><p>Use a <code class="highlighter-rouge">for</code> loop to process multiple files.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>We have created a function called <code class="highlighter-rouge">analyze</code> that creates graphs of the minimum, average, and maximum daily inflammation rates for a single data set:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>analyze &lt;- function(filename) {
  # Plots the average, min, and max inflammation over time.
  # Input is character string of a csv file.
  dat &lt;- read.csv(file = filename, header = FALSE)
  avg_day_inflammation &lt;- apply(dat, 2, mean)
  plot(avg_day_inflammation)
  max_day_inflammation &lt;- apply(dat, 2, max)
  plot(max_day_inflammation)
  min_day_inflammation &lt;- apply(dat, 2, min)
  plot(min_day_inflammation)
}

analyze("data/inflammation-01.csv")
</code></pre>
</div>

<p><img src="../fig/rmd-03-loops-R-inflammation-01-1.png" title="plot of chunk inflammation-01" alt="plot of chunk inflammation-01" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-inflammation-01-2.png" title="plot of chunk inflammation-01" alt="plot of chunk inflammation-01" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-inflammation-01-3.png" title="plot of chunk inflammation-01" alt="plot of chunk inflammation-01" style="display: block; margin: auto;" /></p>

<p>We can use it to analyze other data sets one by one:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>analyze("data/inflammation-02.csv")
</code></pre>
</div>

<p><img src="../fig/rmd-03-loops-R-inflammation-02-1.png" title="plot of chunk inflammation-02" alt="plot of chunk inflammation-02" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-inflammation-02-2.png" title="plot of chunk inflammation-02" alt="plot of chunk inflammation-02" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-inflammation-02-3.png" title="plot of chunk inflammation-02" alt="plot of chunk inflammation-02" style="display: block; margin: auto;" /></p>

<p>but we have a dozen data sets right now and more on the way.
We want to create plots for all our data sets with a single statement.
To do that, we’ll have to teach the computer how to repeat things.</p>

<h3 id="for-loops">For Loops</h3>

<p>Suppose we want to print each word in a sentence.
One way is to use six <code class="highlighter-rouge">print</code> statements:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>best_practice &lt;- c("Let", "the", "computer", "do", "the", "work")
print_words &lt;- function(sentence) {
  print(sentence[1])
  print(sentence[2])
  print(sentence[3])
  print(sentence[4])
  print(sentence[5])
  print(sentence[6])
}

print_words(best_practice)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
[1] "work"
</code></pre>
</div>

<p>but that’s a bad approach for two reasons:</p>

<ol>
  <li>
    <p>It doesn’t scale: if we want to print the elements in a vector that’s hundreds long, we’d be better off just typing them in.</p>
  </li>
  <li>
    <p>It’s fragile: if we give it a longer vector, it only prints part of the data, and if we give it a shorter input, it returns <code class="highlighter-rouge">NA</code> values because we’re asking for elements that don’t exist!</p>
  </li>
</ol>

<div class="r highlighter-rouge"><pre class="highlight"><code>best_practice[-6]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "Let"      "the"      "computer" "do"       "the"     
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code>print_words(best_practice[-6])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
[1] NA
</code></pre>
</div>

<blockquote class="callout">
  <h2 id="not-available">Not Available</h2>

  <p>R has has a special variable, <code class="highlighter-rouge">NA</code>, for designating missing values that are
<strong>N</strong>ot <strong>A</strong>vailable in a data set. See <code class="highlighter-rouge">?NA</code> and <a href="http://cran.r-project.org/doc/manuals/r-release/R-intro.html#Missing-values">An Introduction to R</a>
for more details.</p>
</blockquote>

<p>Here’s a better approach:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>print_words &lt;- function(sentence) {
  for (word in sentence) {
    print(word)
  }
}

print_words(best_practice)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
[1] "work"
</code></pre>
</div>

<p>This is shorter—certainly shorter than something that prints every character in a hundred-letter string—and more robust as well:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>print_words(best_practice[-6])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
</code></pre>
</div>

<p>The improved version of <code class="highlighter-rouge">print_words</code> uses a <a href="../reference/#for-loop">for loop</a> to repeat an operation—in this case, printing—once for each thing in a collection.
The general form of a loop is:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>for (variable in collection) {
  do things with variable
}
</code></pre>
</div>

<p>We can name the <a href="../reference/#loop-variable">loop variable</a> anything we like (with a few <a href="http://cran.r-project.org/doc/manuals/R-intro.html#R-commands_003b-case-sensitivity-etc">restrictions</a>, e.g. the name of the variable cannot start with a digit).
<code class="highlighter-rouge">in</code> is part of the <code class="highlighter-rouge">for</code> syntax.
Note that the body of the loop is enclosed in curly braces <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="p">}</span></code>.
For a single-line loop body, as here, the braces aren’t needed, but it is good practice to include them as we did.</p>

<p>Here’s another loop that repeatedly updates a variable:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>len &lt;- 0
vowels &lt;- c("a", "e", "i", "o", "u")
for (v in vowels) {
  len &lt;- len + 1
}
# Number of vowels
len
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 5
</code></pre>
</div>

<p>It’s worth tracing the execution of this little program step by step.
Since there are five elements in the vector <code class="highlighter-rouge">vowels</code>, the statement inside the loop will be executed five times.
The first time around, <code class="highlighter-rouge">len</code> is zero (the value assigned to it on line 1) and <code class="highlighter-rouge">v</code> is <code class="highlighter-rouge">"a"</code>.
The statement adds 1 to the old value of <code class="highlighter-rouge">len</code>, producing 1, and updates <code class="highlighter-rouge">len</code> to refer to that new value.
The next time around, <code class="highlighter-rouge">v</code> is <code class="highlighter-rouge">"e"</code> and <code class="highlighter-rouge">len</code> is 1, so <code class="highlighter-rouge">len</code> is updated to be 2.
After three more updates, <code class="highlighter-rouge">len</code> is 5; since there is nothing left in the vector <code class="highlighter-rouge">vowels</code> for R to process, the loop finishes.</p>

<p>Note that a loop variable is just a variable that’s being used to record progress in a loop.
It still exists after the loop is over, and we can re-use variables previously defined as loop variables as well:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>letter &lt;- "z"
for (letter in c("a", "b", "c")) {
  print(letter)
}
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "a"
[1] "b"
[1] "c"
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># after the loop, letter is
letter
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "c"
</code></pre>
</div>

<p>Note also that finding the length of a vector is such a common operation that R actually has a built-in function to do it called <code class="highlighter-rouge">length</code>:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>length(vowels)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 5
</code></pre>
</div>

<p><code class="highlighter-rouge">length</code> is much faster than any R function we could write ourselves, and much easier to read than a two-line loop; it will also give us the length of many other things that we haven’t met yet, so we should always use it when we can (see this <a href="../13-supp-data-structures/">lesson</a> to learn more about the different ways to store data in R).</p>

<blockquote class="challenge">
  <h2 id="printing-numbers">Printing Numbers</h2>

  <p>R has a built-in function called <code class="highlighter-rouge">seq</code> that creates a list of numbers:</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>seq(3)
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] 1 2 3
</code></pre>
  </div>

  <p>Using <code class="highlighter-rouge">seq</code>, write a function that prints the first <strong>N</strong> natural numbers, one per line:</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>print_N(3)
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] 1
[1] 2
[1] 3
</code></pre>
  </div>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>
    <div class="r highlighter-rouge"><pre class="highlight"><code>print_N &lt;- function(N) {
  nseq &lt;- seq(N)
  for (num in nseq) {
    print(num)
  }
}
</code></pre>
    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="summing-values">Summing Values</h2>

  <p>Write a function called <code class="highlighter-rouge">total</code> that calculates the sum of the values in a vector.
(R has a built-in function called <code class="highlighter-rouge">sum</code> that does this for you.
Please don’t use it for this exercise.)</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>ex_vec &lt;- c(4, 8, 15, 16, 23, 42)
total(ex_vec)
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] 108
</code></pre>
  </div>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>
    <div class="r highlighter-rouge"><pre class="highlight"><code>total &lt;- function(vec) {
  #calculates the sum of the values in a vector
  vec_sum &lt;- 0
  for (num in vec) {
    vec_sum &lt;- vec_sum + num
  }
  return(vec_sum)
}
</code></pre>
    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="exponentiation">Exponentiation</h2>

  <p>Exponentiation is built into R:</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>2^4
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] 16
</code></pre>
  </div>

  <p>Write a function called <code class="highlighter-rouge">expo</code> that uses a loop to calculate the same result.</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>expo(2, 4)
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] 16
</code></pre>
  </div>

  <blockquote class="solution">
    <h2 id="solution-2">Solution</h2>
    <div class="r highlighter-rouge"><pre class="highlight"><code>expo &lt;- function(base, power) {
  result &lt;- 1
  for (i in seq(power)) {
    result &lt;- result * base
  }
  return(result)
}
</code></pre>
    </div>
  </blockquote>
</blockquote>

<h3 id="processing-multiple-files">Processing Multiple Files</h3>

<p>We now have almost everything we need to process all our data files.
The only thing that’s missing is a function that finds files whose names match a pattern.
We do not need to write it ourselves because R already has a function to do this called <code class="highlighter-rouge">list.files</code>.</p>

<p>If we run the function without any arguments, <code class="highlighter-rouge">list.files()</code>, it returns every file in the current working directory.
We can understand this result by reading the help file (<code class="highlighter-rouge">?list.files</code>).
The first argument, <code class="highlighter-rouge">path</code>, is the path to the directory to be searched, and it has the default value of <code class="highlighter-rouge">"."</code>
(recall from the <a href="https://swcarpentry.github.io/shell-novice/01-filedir/">lesson</a> on the Unix Shell that <code class="highlighter-rouge">"."</code> is shorthand for the current working directory).
The second argument, <code class="highlighter-rouge">pattern</code>, is the pattern being searched, and it has the default value of <code class="highlighter-rouge">NULL</code>.
Since no pattern is specified to filter the files, all files are returned.</p>

<p>So to list all the csv files, we could run either of the following:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>list.files(path = "data", pattern = "csv")
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code> [1] "car-speeds-cleaned.csv" "car-speeds.csv"        
 [3] "inflammation-01.csv"    "inflammation-02.csv"   
 [5] "inflammation-03.csv"    "inflammation-04.csv"   
 [7] "inflammation-05.csv"    "inflammation-06.csv"   
 [9] "inflammation-07.csv"    "inflammation-08.csv"   
[11] "inflammation-09.csv"    "inflammation-10.csv"   
[13] "inflammation-11.csv"    "inflammation-12.csv"   
[15] "sample.csv"             "small-01.csv"          
[17] "small-02.csv"           "small-03.csv"          
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code>list.files(path = "data", pattern = "inflammation")
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code> [1] "inflammation-01.csv" "inflammation-02.csv" "inflammation-03.csv"
 [4] "inflammation-04.csv" "inflammation-05.csv" "inflammation-06.csv"
 [7] "inflammation-07.csv" "inflammation-08.csv" "inflammation-09.csv"
[10] "inflammation-10.csv" "inflammation-11.csv" "inflammation-12.csv"
</code></pre>
</div>

<blockquote class="callout">
  <h2 id="organizing-larger-projects">Organizing Larger Projects</h2>

  <p>For larger projects, it is recommended to organize separate parts of the
analysis into multiple subdirectories, e.g. one subdirectory for the raw data,
one for the code, and one for the results like figures. We have done that here
to some extent, putting all of our data files into the subdirectory “data”.
For more advice on this topic, you can read <a href="http://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1000424">A quick guide to organizing
computational biology projects</a> by William Stafford Noble.</p>
</blockquote>

<p>As these examples show, <code class="highlighter-rouge">list.files</code> result is a vector of strings, which means we can loop over it to do something with each filename in turn.
In our case, the “something” we want is our <code class="highlighter-rouge">analyze</code> function.</p>

<p>Because we have put our data in separate subdirectory, if we want to access these files
using the output of <code class="highlighter-rouge">list.files</code> we also need to include the “path” portion of the file name.
We can do that by using the argument <code class="highlighter-rouge">full.names = TRUE</code>.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>list.files(path = "data", pattern = "csv", full.names = TRUE)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code> [1] "data/car-speeds-cleaned.csv" "data/car-speeds.csv"        
 [3] "data/inflammation-01.csv"    "data/inflammation-02.csv"   
 [5] "data/inflammation-03.csv"    "data/inflammation-04.csv"   
 [7] "data/inflammation-05.csv"    "data/inflammation-06.csv"   
 [9] "data/inflammation-07.csv"    "data/inflammation-08.csv"   
[11] "data/inflammation-09.csv"    "data/inflammation-10.csv"   
[13] "data/inflammation-11.csv"    "data/inflammation-12.csv"   
[15] "data/sample.csv"             "data/small-01.csv"          
[17] "data/small-02.csv"           "data/small-03.csv"          
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code>list.files(path = "data", pattern = "inflammation", full.names = TRUE)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code> [1] "data/inflammation-01.csv" "data/inflammation-02.csv"
 [3] "data/inflammation-03.csv" "data/inflammation-04.csv"
 [5] "data/inflammation-05.csv" "data/inflammation-06.csv"
 [7] "data/inflammation-07.csv" "data/inflammation-08.csv"
 [9] "data/inflammation-09.csv" "data/inflammation-10.csv"
[11] "data/inflammation-11.csv" "data/inflammation-12.csv"
</code></pre>
</div>

<p>Let’s test out running our <code class="highlighter-rouge">analyze</code> function by using it on the first three files in the vector returned by <code class="highlighter-rouge">list.files</code>:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>filenames &lt;- list.files(path = "data", pattern = "inflammation.*csv", full.names = TRUE)
filenames &lt;- filenames[1:3]
for (f in filenames) {
  print(f)
  analyze(f)
}
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "data/inflammation-01.csv"
</code></pre>
</div>

<p><img src="../fig/rmd-03-loops-R-loop-analyze-1.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-loop-analyze-2.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-loop-analyze-3.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /></p>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "data/inflammation-02.csv"
</code></pre>
</div>

<p><img src="../fig/rmd-03-loops-R-loop-analyze-4.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-loop-analyze-5.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-loop-analyze-6.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /></p>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "data/inflammation-03.csv"
</code></pre>
</div>

<p><img src="../fig/rmd-03-loops-R-loop-analyze-7.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-loop-analyze-8.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /><img src="../fig/rmd-03-loops-R-loop-analyze-9.png" title="plot of chunk loop-analyze" alt="plot of chunk loop-analyze" style="display: block; margin: auto;" /></p>

<p>Sure enough, the maxima of these data sets show exactly the same ramp as the first, and their minima show the same staircase structure.</p>

<blockquote class="callout">
  <h2 id="other-ways-to-do-it">Other Ways to Do It</h2>

  <p>In this lesson we saw how to use a simple <code class="highlighter-rouge">for</code> loop to repeat an operation.
As you progress with R, you will learn that there are multiple ways to
accomplish this. Sometimes the choice of one method over another is more a
matter of personal style, but other times it can have consequences for the
speed of your code. For instruction on best practices, see this supplementary
<a href="../15-supp-loops-in-depth/">lesson</a> that demonstrates how to properly repeat
operations in R.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="using-loops-to-analyze-multiple-files">Using Loops to Analyze Multiple Files</h2>

  <p>Write a function called <code class="highlighter-rouge">analyze_all</code> that takes a filename pattern as its sole argument
and runs <code class="highlighter-rouge">analyze</code> for each file whose name matches the pattern.</p>

  <blockquote class="solution">
    <h2 id="solution-3">Solution</h2>
    <div class="r highlighter-rouge"><pre class="highlight"><code>analyze_all &lt;- function(pattern) {
  # Runs the function analyze for each file in the current working directory
  # that contains the given pattern.
  filenames &lt;- list.files(path = "data", pattern = pattern, full.names = TRUE)
  for (f in filenames) {
    analyze(f)
  }
}
</code></pre>
    </div>
  </blockquote>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use <code class="highlighter-rouge">for (variable in collection)</code> to process the elements of a collection one at a time.</p>
</li>
    
    <li><p>The body of a <code class="highlighter-rouge">for</code> loop is surrounded by curly braces (<code class="highlighter-rouge"><span class="p">{}</span></code>).</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">length(thing)</code> to determine the length of something that contains other values.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">list.files(path = "path", pattern = "pattern", full.names = TRUE)</code> to create a list of files whose names match a pattern.</p>
</li>
    
  </ul>
</blockquote>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../02-func-R/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../04-cond/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      <footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016
	<a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="mailto:lessons@software-carpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    <script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
