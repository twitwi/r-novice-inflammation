<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-01-30 00:03:54 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="/swc-releases/1999.12/r-novice-inflammation">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-swc.ico" />
    
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Programming with R: Analyzing Patient Data</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li><a href="../reference/">Reference</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-starting-with-data/">Analyzing Patient Data</a></li>
            
            <li><a href="../02-func-R/">Creating Functions</a></li>
            
            <li><a href="../03-loops-R/">Analyzing Multiple Data Sets</a></li>
            
            <li><a href="../04-cond/">Making Choices</a></li>
            
            <li><a href="../05-cmdline/">Command-Line Programs</a></li>
            
            <li><a href="../06-best-practices-R/">Best Practices for Writing R</a></li>
            
            <li><a href="../07-knitr-R/">Dynamic Reports with knitr</a></li>
            
            <li><a href="../08-making-packages-R/">Making Packages in R</a></li>
            
            <li><a href="../09-supp-intro-rstudio/">Introduction to RStudio</a></li>
            
            <li><a href="../10-supp-addressing-data/">Addressing Data</a></li>
            
            <li><a href="../11-supp-read-write-csv/">Reading and Writing CSV Files</a></li>
            
            <li><a href="../12-supp-factors/">Understanding Factors</a></li>
            
            <li><a href="../13-supp-data-structures/">Data Types and Structures</a></li>
            
            <li><a href="../14-supp-call-stack/">The Call Stack</a></li>
            
            <li><a href="../15-supp-loops-in-depth/">Loops in R</a></li>
            
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Programming with R</a></h3>
    <h1 class="maintitle">Analyzing Patient Data</h1>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../02-func-R/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 45 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I read data into R?</p>
</li>
	
	<li><p>How do I assign variables?</p>
</li>
	
	<li><p>What is a data frame?</p>
</li>
	
	<li><p>How do I access subsets a data frame?</p>
</li>
	
	<li><p>How do I calculate simple statistics like mean and median?</p>
</li>
	
	<li><p>Where can I get help?</p>
</li>
	
	<li><p>How can I plot my data?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Read tabular data from a file into a program.</p>
</li>
	
	<li><p>Assign values to variables.</p>
</li>
	
	<li><p>Select individual values and subsections from data.</p>
</li>
	
	<li><p>Perform operations on a data frame of data.</p>
</li>
	
	<li><p>Display simple graphs.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>We are studying inflammation in patients who have been given a new treatment for arthritis,
and need to analyze the first dozen data sets.
The data sets are stored in <a href="../reference/#comma-separated-values-(csv)">comma-separated values</a> (CSV) format. Each row holds the observations for just one patient. Each column holds the inflammation measured in a day, so we have a set of values in successive days.
The first few rows of our first file look like this:</p>

<div class="output highlighter-rouge"><pre class="highlight"><code>0,0,1,3,1,2,4,7,8,3,3,3,10,5,7,4,7,7,12,18,6,13,11,11,7,7,4,6,8,8,4,4,5,7,3,4,2,3,0,0
0,1,2,1,2,1,3,2,2,6,10,11,5,9,4,4,7,16,8,6,18,4,12,5,12,7,11,5,11,3,3,5,4,4,5,5,1,1,0,1
0,1,1,3,3,2,6,2,5,9,5,7,4,5,4,15,5,11,9,10,19,14,12,17,7,12,11,7,4,2,10,5,4,2,2,3,2,2,1,1
0,0,2,0,4,2,2,1,6,7,10,7,9,13,8,8,15,10,10,7,17,4,4,7,6,15,6,4,9,11,3,5,6,3,3,4,2,3,2,1
0,1,1,3,3,1,3,5,2,4,4,7,6,5,3,10,8,10,6,17,9,14,9,7,13,9,12,6,7,7,9,6,3,2,2,4,2,0,1,1
</code></pre>
</div>

<p>We want to:</p>

<ul>
  <li>Load data into memory,</li>
  <li>Calculate the average value of inflammation per day across all patients, and</li>
  <li>Plot the results.</li>
</ul>

<p>To do all that, we’ll have to learn a little bit about programming.</p>

<h3 id="loading-data">Loading Data</h3>

<p>To load our inflammation data, first we need to tell our computer where is the file that contains the values. We have been told its name is <code class="highlighter-rouge">inflammation-01.csv</code>. This is very important in R, if we forget this step we’ll get an error message when trying to read the file. We can change the current working directory using the function <code class="highlighter-rouge">setwd</code>. For this example, we change the path to the directory we just created:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>setwd("~/Desktop/r-novice-inflammation/")
</code></pre>
</div>

<p>Just like in the Unix Shell, we type the command and then press <code class="highlighter-rouge">Enter</code> (or <code class="highlighter-rouge">return</code>).
Alternatively you can change the working directory using the RStudio GUI using the menu option <code class="highlighter-rouge">Session</code> -&gt; <code class="highlighter-rouge">Set Working Directory</code> -&gt; <code class="highlighter-rouge">Choose Directory...</code></p>

<p>The data files are located in the directory <code class="highlighter-rouge">data</code> inside the working directory. Now we can load the data into R using <code class="highlighter-rouge">read.csv</code>:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>read.csv(file = "data/inflammation-01.csv", header = FALSE)
</code></pre>
</div>

<p>The expression <code class="highlighter-rouge">read.csv(...)</code> is a <a href="../reference/#function-call">function call</a> that asks R to run the function <code class="highlighter-rouge">read.csv</code>.</p>

<p><code class="highlighter-rouge">read.csv</code> has two <a href="../reference/#argument">arguments</a>: the name of the file we want to read, and whether the first line of the file contains names for the columns of data.
The filename needs to be a character string (or <a href="../reference/#string">string</a> for short), so we put it in quotes. Assigning the second argument, <code class="highlighter-rouge">header</code>, to be <code class="highlighter-rouge">FALSE</code> indicates that the data file does not have column headers. We’ll talk more about the value <code class="highlighter-rouge">FALSE</code>, and its converse <code class="highlighter-rouge">TRUE</code>, in lesson 04.</p>

<blockquote class="callout">
  <h2 id="other-options-for-reading-csv-files">Other Options for Reading CSV Files</h2>

  <p><code class="highlighter-rouge">read.csv</code> actually has many more arguments that you may find useful when
importing your own data in the future. You can learn more about these
options in this supplementary <a href="../11-supp-read-write-csv/">lesson</a>.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="loading-data-with-headers">Loading Data with Headers</h2>

  <p>What happens if you forget to put <code class="highlighter-rouge">header = FALSE</code>? The default value is <code class="highlighter-rouge">header = TRUE</code>, which you can check with <code class="highlighter-rouge">?read.csv</code> or <code class="highlighter-rouge">help(read.csv)</code>. What do you expect will happen if you leave the default value? Before you run any code, think about what will happen to the first few rows of your data frame, and its overall size. Then run the following code and see if your expectations agree:</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>read.csv(file = "data/inflammation-01.csv")
</code></pre>
  </div>
</blockquote>

<blockquote class="challenge">
  <h2 id="reading-different-decimal-point-formats">Reading Different Decimal Point Formats</h2>

  <p>Depending on the country you live in, your standard can use the dot or the comma as decimal mark.
Also, different devices or software can generate data with different decimal points.
Take a look at <code class="highlighter-rouge">?read.csv</code> and write the code to load a file called <code class="highlighter-rouge">commadec.txt</code> that has numeric values with commas as decimal mark, separated by semicolons.</p>
</blockquote>

<p>The utility of a function is that it will perform its given action on whatever value is passed to the named argument(s).
For example, in this case if we provided the name of a different file to the argument <code class="highlighter-rouge">file</code>, <code class="highlighter-rouge">read.csv</code> would read it instead.
We’ll learn more of the details about functions and their arguments in the next lesson.</p>

<p>Since we didn’t tell it to do anything else with the function’s output, the console will display the full contents of the file <code class="highlighter-rouge">inflammation-01.csv</code>.
Try it out.</p>

<p><code class="highlighter-rouge">read.csv</code> read the file, but we can’t use data unless we assign it to a variable.
A variable is just a name for a value, such as <code class="highlighter-rouge">x</code>, <code class="highlighter-rouge">current_temperature</code>, or <code class="highlighter-rouge">subject_id</code>.
We can create a new variable simply by assigning a value to it using <code class="highlighter-rouge">&lt;-</code></p>

<div class="r highlighter-rouge"><pre class="highlight"><code>weight_kg &lt;- 55
</code></pre>
</div>

<p>Once a variable has a value, we can print it by typing the name of the variable and hitting <code class="highlighter-rouge">Enter</code> (or <code class="highlighter-rouge">return</code>).
In general, R will print to the console any object returned by a function or operation <em>unless</em> we assign it to a variable.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>weight_kg
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 55
</code></pre>
</div>

<p>We can do arithmetic with the variable:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code># weight in pounds:
2.2 * weight_kg
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 121
</code></pre>
</div>

<blockquote class="callout">
  <h2 id="commenting">Commenting</h2>

  <p>We can add comments to our code using the <code class="highlighter-rouge">#</code> character. It is useful to
document our code in this way so that others (and us the next time we
read it) have an easier time following what the code is doing.</p>
</blockquote>

<p>We can also change an object’s value by assigning it a new value:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>weight_kg &lt;- 57.5
# weight in kilograms is now
weight_kg
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 57.5
</code></pre>
</div>

<p>If we imagine the variable as a sticky note with a name written on it,
assignment is like putting the sticky note on a particular value:</p>

<p><img src="../fig/python-sticky-note-variables-01.svg" alt="Variables as Sticky Notes" /></p>

<p>This means that assigning a value to one object does not change the values of other variables.
For example, let’s store the subject’s weight in pounds in a variable:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>weight_lb &lt;- 2.2 * weight_kg
# weight in kg...
weight_kg
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 57.5
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># ...and in pounds
weight_lb
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 126.5
</code></pre>
</div>

<p><img src="../fig/python-sticky-note-variables-02.svg" alt="Creating Another Variable" /></p>

<p>and then change <code class="highlighter-rouge">weight_kg</code>:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>weight_kg &lt;- 100.0
# weight in kg now...
weight_kg
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 100
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># ...and weight in pounds still
weight_lb
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 126.5
</code></pre>
</div>

<p><img src="../fig/python-sticky-note-variables-03.svg" alt="Updating a Variable" /></p>

<p>Since <code class="highlighter-rouge">weight_lb</code> doesn’t “remember” where its value came from, it isn’t automatically updated when <code class="highlighter-rouge">weight_kg</code> changes.
This is different from the way spreadsheets work.</p>

<blockquote class="callout">
  <h2 id="printing-with-parentheses">Printing with Parentheses</h2>

  <p>An alternative way to print the value of a variable is to use () around the assignment statement.
As an example: <code class="highlighter-rouge">(total_weight &lt;- weight_kg + weight_lb)</code> adds the values of <code class="highlighter-rouge">weight_kg</code> and <code class="highlighter-rouge">weight_lb</code>,
assigns the result to the <code class="highlighter-rouge">total_weight</code>,
and finally prints the assigned value of the variable <code class="highlighter-rouge">total_weight</code>.</p>
</blockquote>

<p>Now that we know how to assign things to variables, let’s re-run <code class="highlighter-rouge">read.csv</code> and save its result:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>dat &lt;- read.csv(file = "data/inflammation-01.csv", header = FALSE)
</code></pre>
</div>

<p>This statement doesn’t produce any output because assignment doesn’t display anything.
If we want to check that our data has been loaded, we can print the variable’s value.
However, for large data sets it is convenient to use the function <code class="highlighter-rouge">head</code> to display only the first few rows of data.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>head(dat)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20
1  0  0  1  3  1  2  4  7  8   3   3   3  10   5   7   4   7   7  12  18
2  0  1  2  1  2  1  3  2  2   6  10  11   5   9   4   4   7  16   8   6
3  0  1  1  3  3  2  6  2  5   9   5   7   4   5   4  15   5  11   9  10
4  0  0  2  0  4  2  2  1  6   7  10   7   9  13   8   8  15  10  10   7
5  0  1  1  3  3  1  3  5  2   4   4   7   6   5   3  10   8  10   6  17
6  0  0  1  2  2  4  2  1  6   4   7   6   6   9   9  15   4  16  18  12
  V21 V22 V23 V24 V25 V26 V27 V28 V29 V30 V31 V32 V33 V34 V35 V36 V37 V38
1   6  13  11  11   7   7   4   6   8   8   4   4   5   7   3   4   2   3
2  18   4  12   5  12   7  11   5  11   3   3   5   4   4   5   5   1   1
3  19  14  12  17   7  12  11   7   4   2  10   5   4   2   2   3   2   2
4  17   4   4   7   6  15   6   4   9  11   3   5   6   3   3   4   2   3
5   9  14   9   7  13   9  12   6   7   7   9   6   3   2   2   4   2   0
6  12   5  18   9   5   3  10   3  12   7   8   4   7   3   5   4   4   3
  V39 V40
1   0   0
2   0   1
3   1   1
4   2   1
5   1   1
6   2   1
</code></pre>
</div>

<blockquote class="challenge">
  <h2 id="assigning-values-to-variables">Assigning Values to Variables</h2>

  <p>Draw diagrams showing what variables refer to what values after each statement in the following program:</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>mass &lt;- 47.5
age &lt;- 122
mass &lt;- mass * 2.0
age &lt;- age - 20
</code></pre>
  </div>
</blockquote>

<h3 id="manipulating-data">Manipulating Data</h3>

<p>Now that our data is loaded in memory, we can start doing things with it.
First, let’s ask what type of thing <code class="highlighter-rouge">dat</code> is:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>class(dat)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] "data.frame"
</code></pre>
</div>

<p>The output tells us that is a data frame. Think of this structure as a spreadsheet in MS Excel that many of us are familiar with.
Data frames are very useful for storing data and you will find them elsewhere when programming in R. A typical data frame of experimental data contains individual observations in rows and variables in columns.</p>

<p>We can see the shape, or <a href="../reference/#dimensions">dimensions</a>, of the data frame with the function <code class="highlighter-rouge">dim</code>:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>dim(dat)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 60 40
</code></pre>
</div>

<p>This tells us that our data frame, <code class="highlighter-rouge">dat</code>, has 60 rows and 40 columns.</p>

<p>If we want to get a single value from the data frame, we can provide an <a href="../reference/#index">index</a> in square brackets, just as we do in math:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code># first value in dat
dat[1, 1]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 0
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># middle value in dat
dat[30, 20]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 16
</code></pre>
</div>

<p>An index like <code class="highlighter-rouge">[30, 20]</code> selects a single element of a data frame, but we can select whole sections as well.
For example, we can select the first ten days (columns) of values for the first four patients (rows) like this:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>dat[1:4, 1:10]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
1  0  0  1  3  1  2  4  7  8   3
2  0  1  2  1  2  1  3  2  2   6
3  0  1  1  3  3  2  6  2  5   9
4  0  0  2  0  4  2  2  1  6   7
</code></pre>
</div>

<p>The <a href="../reference/#slice">slice</a> <code class="highlighter-rouge">1:4</code> means, “Start at index 1 and go to index 4.”</p>

<p>The slice does not need to start at 1, e.g. the line below selects rows 5 through 10:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>dat[5:10, 1:10]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>   V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
5   0  1  1  3  3  1  3  5  2   4
6   0  0  1  2  2  4  2  1  6   4
7   0  0  2  2  4  2  2  5  5   8
8   0  0  1  2  3  1  2  3  5   3
9   0  0  0  3  1  5  6  5  5   8
10  0  1  1  2  1  3  5  3  5   8
</code></pre>
</div>
<p>We can use the function <code class="highlighter-rouge">c</code>, which stands for <strong>c</strong>ombine, to select non-contiguous values:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>dat[c(3, 8, 37, 56), c(10, 14, 29)]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>   V10 V14 V29
3    9   5   4
8    3   5   6
37   6   9  10
56   7  11   9
</code></pre>
</div>

<p>We also don’t have to provide a slice for either the rows or the columns.
If we don’t include a slice for the rows, R returns all the rows; if we don’t include a slice for the columns, R returns all the columns.
If we don’t provide a slice for either rows or columns, e.g. <code class="highlighter-rouge">dat[, ]</code>, R returns the full data frame.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code># All columns from row 5
dat[5, ]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20
5  0  1  1  3  3  1  3  5  2   4   4   7   6   5   3  10   8  10   6  17
  V21 V22 V23 V24 V25 V26 V27 V28 V29 V30 V31 V32 V33 V34 V35 V36 V37 V38
5   9  14   9   7  13   9  12   6   7   7   9   6   3   2   2   4   2   0
  V39 V40
5   1   1
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># All rows from column 16
dat[, 16]
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code> [1]  4  4 15  8 10 15 13  9 11  6  3  8 12  3  5 10 11  4 11 13 15  5 14
[24] 13  4  9 13  6  7  6 14  3 15  4 15 11  7 10 15  6  5  6 15 11 15  6
[47] 11 15 14  4 10 15 11  6 13  8  4 13 12  9
</code></pre>
</div>

<blockquote class="callout">
  <h2 id="addressing-columns-by-name">Addressing Columns by Name</h2>

  <p>Columns can also be addressed by name, with either the <code class="highlighter-rouge">$</code> operator (ie. <code class="highlighter-rouge">dat$Age</code>) or square brackets (ie. <code class="highlighter-rouge">dat[,'Age']</code>).
You can learn more about subsetting by column name in this supplementary <a href="../10-supp-addressing-data/">lesson</a>.</p>
</blockquote>

<p>Now let’s perform some common mathematical operations to learn about our inflammation data.
When analyzing data we often want to look at partial statistics, such as the maximum value per patient or the average value per day.
One way to do this is to select the data we want to create a new temporary data frame, and then perform the calculation on this subset:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code># first row, all of the columns
patient_1 &lt;- dat[1, ]
# max inflammation for patient 1
max(patient_1)
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 18
</code></pre>
</div>

<blockquote class="callout">
  <h2 id="forcing-conversion">Forcing Conversion</h2>

  <p>The code above may give you an error in some R installations,
since R does not automatically convert a sliced row of a <code class="highlighter-rouge">data.frame</code> to a vector.
(Confusingly, sliced columns are automatically converted.)
If this happens, you can use the <code class="highlighter-rouge">as.numeric</code> command to convert the row of data to a numeric vector:</p>

  <p><code class="highlighter-rouge">patient_1 &lt;- as.numeric(dat[1, ])</code></p>

  <p><code class="highlighter-rouge">max(patient_1)</code></p>

  <p>You can also check the <code class="highlighter-rouge">class</code> of each object:</p>

  <p><code class="highlighter-rouge">class(dat[1, ])</code></p>

  <p><code class="highlighter-rouge">class(as.numeric(dat[1, ]))</code></p>
</blockquote>

<p>We don’t actually need to store the row in a variable of its own.
Instead, we can combine the selection and the function call:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code># max inflammation for patient 2
max(dat[2, ])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 18
</code></pre>
</div>

<p>R also has functions for other common calculations, e.g. finding the minimum, mean, median, and standard deviation of the data:</p>

<div class="r highlighter-rouge"><pre class="highlight"><code># minimum inflammation on day 7
min(dat[, 7])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 1
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># mean inflammation on day 7
mean(dat[, 7])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 3.8
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># median inflammation on day 7
median(dat[, 7])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 4
</code></pre>
</div>

<div class="r highlighter-rouge"><pre class="highlight"><code># standard deviation of inflammation on day 7
sd(dat[, 7])
</code></pre>
</div>

<div class="output highlighter-rouge"><pre class="highlight"><code>[1] 1.725187
</code></pre>
</div>

<p>What if we need the maximum inflammation for all patients, or the average for each day?
As the diagram below shows, we want to perform the operation across a margin of the data frame:</p>

<p><img src="../fig/r-operations-across-axes.svg" alt="Operations Across Axes" /></p>

<p>To support this, we can use the <code class="highlighter-rouge">apply</code> function.</p>

<blockquote class="callout">
  <h2 id="getting-help">Getting Help</h2>

  <p>To learn about a function in R, e.g. <code class="highlighter-rouge">apply</code>, we can read its help
documention by running <code class="highlighter-rouge">help(apply)</code> or <code class="highlighter-rouge">?apply</code>.</p>
</blockquote>

<p><code class="highlighter-rouge">apply</code> allows us to repeat a function on all of the rows (<code class="highlighter-rouge">MARGIN = 1</code>) or columns (<code class="highlighter-rouge">MARGIN = 2</code>) of a data frame.</p>

<p>Thus, to obtain the average inflammation of each patient we will need to calculate the mean of all of the rows (<code class="highlighter-rouge">MARGIN = 1</code>) of the data frame.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>avg_patient_inflammation &lt;- apply(dat, 1, mean)
</code></pre>
</div>

<p>And to obtain the average inflammation of each day we will need to calculate the mean of all of the columns (<code class="highlighter-rouge">MARGIN = 2</code>) of the data frame.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>avg_day_inflammation &lt;- apply(dat, 2, mean)
</code></pre>
</div>

<p>Since the second argument to <code class="highlighter-rouge">apply</code> is <code class="highlighter-rouge">MARGIN</code>, the above command is equivalent to <code class="highlighter-rouge">apply(dat, MARGIN = 2, mean)</code>.
We’ll learn why this is so in the next lesson.</p>

<blockquote class="callout">
  <h2 id="efficient-alternatives">Efficient Alternatives</h2>

  <p>Some common operations have more efficient alternatives. For example, you
can calculate the row-wise or column-wise means with <code class="highlighter-rouge">rowMeans</code> and
<code class="highlighter-rouge">colMeans</code>, respectively.</p>
</blockquote>

<blockquote class="challenge">
  <h2 id="slicing-subsetting-data">Slicing (Subsetting) Data</h2>

  <p>A subsection of a data frame is called a <a href="../reference/#slice">slice</a>.
We can take slices of character vectors as well:</p>

  <div class="r highlighter-rouge"><pre class="highlight"><code>animal &lt;- c("m", "o", "n", "k", "e", "y")
# first three characters
animal[1:3]
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] "m" "o" "n"
</code></pre>
  </div>

  <div class="r highlighter-rouge"><pre class="highlight"><code># last three characters
animal[4:6]
</code></pre>
  </div>

  <div class="output highlighter-rouge"><pre class="highlight"><code>[1] "k" "e" "y"
</code></pre>
  </div>

  <ol>
    <li>
      <p>If the first four characters are selected using the slice <code class="highlighter-rouge">animal[1:4]</code>, how can we obtain the first four characters in reverse order?</p>
    </li>
    <li>
      <p>What is <code class="highlighter-rouge">animal[-1]</code>?
   What is <code class="highlighter-rouge">animal[-4]</code>?
   Given those answers,
   explain what <code class="highlighter-rouge">animal[-1:-4]</code> does.</p>
    </li>
    <li>
      <p>Use a slice of <code class="highlighter-rouge">animal</code> to create a new character vector that spells the word “eon”, i.e. <code class="highlighter-rouge">c("e", "o", "n")</code>.</p>
    </li>
  </ol>
</blockquote>

<blockquote class="challenge">
  <h2 id="subsetting-more-data">Subsetting More Data</h2>

  <p>Suppose you want to determine the maximum inflammation for patient 5 across days three to seven.
To do this you would extract the relevant slice from the data frame and calculate the maximum value.
Which of the following lines of R code gives the correct answer?</p>

  <ol>
    <li><code class="highlighter-rouge">max(dat[5, ])</code></li>
    <li><code class="highlighter-rouge">max(dat[3:7, 5])</code></li>
    <li><code class="highlighter-rouge">max(dat[5, 3:7])</code></li>
    <li><code class="highlighter-rouge">max(dat[5, 3, 7])</code></li>
  </ol>
</blockquote>

<blockquote class="challenge">
  <h2 id="slicing-and-re-assignment">Slicing and Re-Assignment</h2>

  <p>Using the inflammation data frame <code class="highlighter-rouge">dat</code> from above:
Let’s pretend there was something wrong with the instrument on the first five days for every second patient (#2, 4, 6, etc.), which resulted in the measurements being twice as large as they should be.</p>

  <ol>
    <li>Write a vector containing each affected patient (hint: <code class="highlighter-rouge">? seq</code>)</li>
    <li>Create a new data frame with in which you halve the first five days’ values in only those patients</li>
    <li>Print out the corrected data frame to check that your code has fixed the problem</li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>
    <div class="r highlighter-rouge"><pre class="highlight"><code>whichPatients &lt;- seq(2,40,2)
whichDays &lt;- c(1:5)
dat2 &lt;- dat
dat2[whichPatients,whichDays] &lt;- dat2[whichPatients,whichDays]/2
(dat2)
</code></pre>
    </div>
  </blockquote>
</blockquote>

<blockquote class="challenge">
  <h2 id="using-the-apply-function-on-patient-data">Using the Apply Function on Patient Data</h2>

  <p>Challenge: the apply function can be used to summarize datasets and subsets
of data across rows and columns using the MARGIN argument.
Suppose you want to calculate the mean inflammation for specific days and patients
in the patient dataset (i.e. 60 patients across 40 days).</p>

  <p>Please use a combination of the apply function and indexing to:</p>

  <ol>
    <li>calculate the mean inflammation for patients 1 to 5 over the whole 40 days</li>
    <li>calculate the mean inflammation for days 1 to 10 (across all patients).</li>
    <li>calculate the mean inflammation for every second day (across all patients).</li>
  </ol>

  <p>Think about the number of rows and columns you would expect as the result before each
apply call and check your intuition by applying the mean function.</p>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>
    <div class="r highlighter-rouge"><pre class="highlight"><code># 1.
apply(dat[1:5, ], 1, mean)
# 2.
apply(dat[, 1:10], 2, mean)
# 3.
apply(dat[, seq(1,40, by=2)], 2, mean)
</code></pre>
    </div>
  </blockquote>
</blockquote>

<h3 id="plotting">Plotting</h3>

<p>The mathematician Richard Hamming once said, “The purpose of computing is insight, not numbers,” and the best way to develop insight is often to visualize data.
Visualization deserves an entire lecture (or course) of its own, but we can explore a few of R’s plotting features.</p>

<p>Let’s take a look at the average inflammation over time.
Recall that we already calculated these values above using <code class="highlighter-rouge">apply(dat, 2, mean)</code> and saved them in the variable <code class="highlighter-rouge">avg_day_inflammation</code>.
Plotting the values is done with the function <code class="highlighter-rouge">plot</code>.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>plot(avg_day_inflammation)
</code></pre>
</div>

<p><img src="../fig/rmd-01-starting-with-data-plot-avg-inflammation-1.png" title="plot of chunk plot-avg-inflammation" alt="plot of chunk plot-avg-inflammation" style="display: block; margin: auto;" /></p>

<p>Above, we gave the function <code class="highlighter-rouge">plot</code> a vector of numbers corresponding to the average inflammation per day across all patients.
<code class="highlighter-rouge">plot</code> created a scatter plot where the y-axis is the average inflammation level and the x-axis is the order, or index, of the values in the vector, which in this case correspond to the 40 days of treatment.
The result is roughly a linear rise and fall, which is suspicious: based on other studies, we expect a sharper rise and slower fall.
Let’s have a look at two other statistics: the maximum and minimum inflammation per day.</p>

<div class="r highlighter-rouge"><pre class="highlight"><code>max_day_inflammation &lt;- apply(dat, 2, max)
plot(max_day_inflammation)
</code></pre>
</div>

<p><img src="../fig/rmd-01-starting-with-data-plot-max-inflammation-1.png" title="plot of chunk plot-max-inflammation" alt="plot of chunk plot-max-inflammation" style="display: block; margin: auto;" /></p>

<div class="r highlighter-rouge"><pre class="highlight"><code>min_day_inflammation &lt;- apply(dat, 2, min)
plot(min_day_inflammation)
</code></pre>
</div>

<p><img src="../fig/rmd-01-starting-with-data-plot-min-inflammation-1.png" title="plot of chunk plot-min-inflammation" alt="plot of chunk plot-min-inflammation" style="display: block; margin: auto;" /></p>

<p>The maximum value rises and falls perfectly smoothly, while the minimum seems to be a step function. Neither result seems particularly likely, so either there’s a mistake in our calculations or something is wrong with our data.</p>

<blockquote class="challenge">
  <h2 id="plotting-data">Plotting Data</h2>

  <p>Create a plot showing the standard deviation of the inflammation data for each day across all patients.</p>
</blockquote>

<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use <code class="highlighter-rouge">variable &lt;- value</code> to assign a value to a variable in order to record it in memory.</p>
</li>
    
    <li><p>Objects are created on demand whenever a value is assigned to them.</p>
</li>
    
    <li><p>The function <code class="highlighter-rouge">dim</code> gives the dimensions of a data frame.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">object[x, y]</code> to select a single element from a data frame.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">from:to</code> to specify a sequence that includes the indices from <code class="highlighter-rouge">from</code> to <code class="highlighter-rouge">to</code>.</p>
</li>
    
    <li><p>All the indexing and slicing that works on data frames also works on vectors.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">#</code> to add comments to programs.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">mean</code>, <code class="highlighter-rouge">max</code>, <code class="highlighter-rouge">min</code> and <code class="highlighter-rouge">sd</code> to calculate simple statistics.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">apply</code> to calculate statistics across the rows or columns of a data frame.</p>
</li>
    
    <li><p>Use <code class="highlighter-rouge">plot</code> to create simple visualizations.</p>
</li>
    
  </ul>
</blockquote>





<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../02-func-R/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      <footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016
	<a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="mailto:lessons@software-carpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    <script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
